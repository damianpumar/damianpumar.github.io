<!DOCTYPE html><p>If for some reason you need to reuse a vue component in a directive I would like to share with you the best way I found to do it.</p>
<h2 id="scenario">Scenario üçø</h2>
<p>I had vue component used to copy text into many components üëá</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="vue"><code><span class="line"><span style="color:#E1E4E8">//components/CopyCode.component.vue</span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">template</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#85E89D">base-action-tooltip</span><span style="color:#B392F0"> class</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"button"</span><span style="color:#B392F0"> tooltip</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"Copied"</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;</span><span style="color:#85E89D">a</span><span style="color:#B392F0"> href</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"#"</span><span style="color:#B392F0"> @click.prevent</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"copy(code)"</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#85E89D">svgicon</span><span style="color:#B392F0"> name</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"copy"</span><span style="color:#B392F0"> width</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"16"</span><span style="color:#B392F0"> height</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"16"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;</span><span style="color:#85E89D">a</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;/</span><span style="color:#85E89D">base-action-tooltip</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">template</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">script</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#9ECBFF"> "assets/icons/copy"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> default</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  props: {</span></span>
<span class="line"><span style="color:#E1E4E8">    code: {</span></span>
<span class="line"><span style="color:#E1E4E8">      type: String,</span></span>
<span class="line"><span style="color:#E1E4E8">      required: </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  },</span></span>
<span class="line"><span style="color:#E1E4E8">  methods: {</span></span>
<span class="line"><span style="color:#B392F0">    copy</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">code</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">      this</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">$copyToClipboard</span><span style="color:#E1E4E8">(code);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">script</span><span style="color:#E1E4E8">></span></span></code></pre>
<h2 id="problem">Problem ü§î</h2>
<p>For some reason I needed to reuse the same behavior in a vue directive, as you know directives are a bit limited to reuse components and functions, but I found a way to reuse any component. I know that reusing components in a directive is not a good practice, but sometimes it is necessary to do it because you will have to rewrite all the vue code in vanilla javascript, and sometimes that would be a lot of work, right?</p>
<h2 id="solution">Solution ü§ì</h2>
<p>Let me explain how you can reuse a vue component inside a directive. In my case, I need to add the copy functionality in a vue directive called ‚Äúcopy-code‚Äù.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Vue </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "vue"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> CopyCodeComponent </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "./CopyCode.component.vue"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">Vue.</span><span style="color:#B392F0">directive</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"copy-code"</span><span style="color:#E1E4E8">, {</span></span>
<span class="line"><span style="color:#B392F0">  bind</span><span style="color:#E1E4E8">: (</span><span style="color:#FFAB70">element</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">_</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">node</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">    //...</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> copyCode</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> Vue.</span><span style="color:#B392F0">extend</span><span style="color:#E1E4E8">(CopyCodeComponent);</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> instance</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> copyCode</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">      propsData: { code },</span></span>
<span class="line"><span style="color:#E1E4E8">      $copyToClipboard: node.context.$copyToClipboard,</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    instance.</span><span style="color:#B392F0">$mount</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">    container.</span><span style="color:#B392F0">appendChild</span><span style="color:#E1E4E8">(instance.$el);</span></span>
<span class="line"><span style="color:#6A737D">    //...</span></span>
<span class="line"><span style="color:#E1E4E8">  },</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre>
<p>In a bind function you have the element that is using your directive, but in the node object you have the Vue component with the application context.</p>
<p>You just need to extend the component with Vue and instantiate it with all the props you need and pass the context props if you are using custom plugins, global states, etc.</p>
<p>Hopefully it will be useful for you ü§û</p>
<p>Bye üëã</p>