<!DOCTYPE html><p>Sometimes we need to add new functionality to an existing object, but we don’t want to modify the existing structure of the object, we want to add the new functionality in a transparent way for the consumer, still all tests passing and no violate any SOLID principle.</p>
<p>To achieve this we can use the decorator pattern 💪.</p>
<h1 id="what-is-the-decorator-pattern">What is the decorator pattern? 🤔</h1>
<p>The decorator pattern is a design pattern that allows us to add new functionality to an existing object without modifying its structure. The decorator pattern is a structural pattern, part of 23 GOF patterns.</p>
<h2 id="advantages-of-the-decorator-pattern">Advantages of the decorator pattern 🤩</h2>
<ul>
<li>Add new functionality without modifying the existing structure.</li>
<li>Add new functionality at runtime.</li>
<li>Add new functionality to an existing object in a transparent way for the consumer.</li>
</ul>
<h2 id="disadvantages-of-the-decorator-pattern">Disadvantages of the decorator pattern 😔</h2>
<ul>
<li>It can generate a lot of classes if we use it in an uncontrolled way.</li>
</ul>
<h1 id="how-to-implement-the-decorator-pattern-in-typescript">How to implement the decorator pattern in Typescript? 🤓</h1>
<p>Imagine that we have a class has an existing behavior, but we need to extends this functionality but in other object instead to add new lines on the existing class.</p>
<p>For example imagine that we have a class called <code>NotificationSender</code> that has a method called <code>send</code> that sends a notification to a user via email. Now we need to add a new functionality to this class, for example we need to send two notifications to the user, one by email and another by sms.</p>
<p>We could modify the <code>NotificationSender</code> class and add the new functionality, but this would violate the open-closed principle, which says that a class should be open for extension but closed for modification. For this reason we will use the decorator pattern.</p>
<p>Let’s see the original <code>NotificationSender</code> class 👇</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> NotificationSender</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">  send</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">user</span><span style="color:#F97583">:</span><span style="color:#B392F0"> User</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">message</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#6A737D">    // send notification to user by email</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>And now let’s see how we can add the new functionality using the decorator pattern 👇</p>
<h2 id="first-step-️">First step 🏃‍♂️</h2>
<p>The first step is to create an interface that defines the behavior of the class that we want to decorate. In our case we will create an interface called <code>INotificationSender</code> that defines the behavior of the <code>NotificationSender</code>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">interface</span><span style="color:#B392F0"> INotificationSender</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">  send</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">user</span><span style="color:#F97583">:</span><span style="color:#B392F0"> User</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">message</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="second-step-️">Second step 🏃‍♂️</h2>
<p>Extend the <code>NotificationSender</code> class to implement the <code>INotificationSender</code> interface.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> NotificationSender</span><span style="color:#F97583"> implements</span><span style="color:#B392F0"> INotificationSender</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">  send</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">user</span><span style="color:#F97583">:</span><span style="color:#B392F0"> User</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">message</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#6A737D">    // send notification to user by email</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="third-step-️">Third step 🏃‍♂️</h2>
<p>Create a class that implements the <code>INotificationSender</code> interface and receives an instance of the <code>INotificationSender</code> interface in the constructor. In our case we will create a class called <code>NotificationSenderViaSMS</code> that implements the <code>INotificationSender</code> interface.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> NotificationSenderViaSMS</span><span style="color:#F97583"> implements</span><span style="color:#B392F0"> INotificationSender</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  constructor</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">private</span><span style="color:#FFAB70"> notificationSender</span><span style="color:#F97583">:</span><span style="color:#B392F0"> INotificationSender</span><span style="color:#E1E4E8">) {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  send</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">user</span><span style="color:#F97583">:</span><span style="color:#B392F0"> User</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">message</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.notificationSender.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(user, message);</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>This is the key of the decorator pattern, the <code>INotificationSender</code> implementation class receives an instance of the <code>INotificationSender</code> (other object with same type).</p>
<h2 id="fourth-step-️">Fourth step 🏃‍♂️</h2>
<p>Implement the sms notification into <code>NotificationSenderViaSMS</code> class.</p>
<p>First we send the notification by email using the <code>notificationSender</code> instance and then we send the notification by sms.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> NotificationSenderViaSMS</span><span style="color:#F97583"> implements</span><span style="color:#B392F0"> INotificationSender</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  constructor</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">private</span><span style="color:#FFAB70"> notificationSender</span><span style="color:#F97583">:</span><span style="color:#B392F0"> INotificationSender</span><span style="color:#E1E4E8">) {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">  send</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">user</span><span style="color:#F97583">:</span><span style="color:#B392F0"> User</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">message</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">    this</span><span style="color:#E1E4E8">.notificationSender.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(user, message);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    // Here send notification to user by sms</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="last-step-️">Last step 🏃‍♂️</h2>
<p>We need to modify the instantiation of the <code>NotificationSender</code> class to use the <code>NotificationSenderViaSMS</code> class and pass it the <code>NotificationSender</code> instance.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#6A737D">// Previous code</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> notificationSender</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> NotificationSender</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// New code</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> notificationSender</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> NotificationSenderViaSMS</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#F97583">  new</span><span style="color:#B392F0"> NotificationSender</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">);</span></span></code></pre>
<h1 id="conclusion">Conclusion 🤓</h1>
<p>The decorator pattern is a very useful pattern that allows us to add new functionality to an existing object without modifying its structure, as a consumer just modify the instantiation of the class and the decorator pattern does the rest.</p>
<h1 id="references">References 📚</h1>
<ul>
<li><a href="https://refactoring.guru/design-patterns/decorator">Decorator Pattern</a></li>
</ul>
<p>Bye 🙌</p>